# 视觉输入模块使用指南

## ✨ 功能概览

视觉输入模块 (ImageInputProcessor) 允许你通过截图识别对话内容，自动填充到场景描述输入框。

## 🎯 使用方法

### 1. 切换输入模式
- 点击输入区域右上角的 **"📸 使用截图识别"** 按钮
- 切换回文字输入：点击 **"📝 切换到文字输入"**

### 2. 上传截图（三种方式）
- **方式1**：点击上传区，选择本地图片
- **方式2**：直接拖拽截图到上传区
- **方式3**：按 `Ctrl+V` 粘贴剪贴板中的截图（最快捷！）

### 3. 框选识别区域
- 上传后会打开裁剪模态框
- 拖动白色边框，框选**对方的对话气泡**
- 调整四角的圆形手柄精确定位
- 点击 **"开始识别"**

### 4. 校对文本
- 左侧显示裁剪的图片片段
- 右侧显示识别出的文本（可编辑）
- 确认无误后点击 **"确认并填充"**
- 识别结果会自动填充到场景描述输入框

## 💡 使用技巧

### 提高识别率
1. **清晰截图**：确保截图文字清晰，避免模糊
2. **精确框选**：只框选需要识别的文字区域
3. **避免背景干扰**：尽量框选纯色背景上的文字

### 最佳实践
- ✅ **推荐**：只框选对方的一条对话气泡
- ✅ **推荐**：使用微信/QQ等聊天截图（左侧为对方）
- ⚠️ **避免**：一次框选多条对话（可能混乱）
- ⚠️ **避免**：框选表情包或图片（无法识别）

## 🔧 技术实现

### 核心依赖
- **react-image-crop**: 图片裁剪功能
- **tesseract.js**: OCR文字识别（支持中英文）
- **Canvas API**: 图像预处理（灰度化+二值化）

### 预处理算法
系统会自动对图片进行预处理以提高识别率：
1. **灰度化**：将彩色图片转为灰度图
2. **对比度增强**：增强文字与背景的对比度
3. **二值化**：阈值处理，黑白分明

### 识别流程
```
上传截图 → 框选区域 → 图像预处理 → OCR识别 → 文本校对 → 自动填充
```

## 🎨 UI 设计特点

- **Apple 风格毛玻璃效果**：dropzone 和模态框均采用磨砂玻璃质感
- **激光扫描动画**：识别时显示从左到右的渐变光束，提升科技感
- **高对比度裁剪框**：白色高亮边框 + 深色遮罩层，精确框选
- **响应式布局**：适配桌面和移动端

## ⚠️ 注意事项

1. **首次加载较慢**：Tesseract.js 需要下载语言包（约 10MB），请耐心等待
2. **识别准确率**：中文识别率约 85-90%，请务必在校对窗口检查
3. **网络依赖**：语言包从 CDN 加载，需要网络连接
4. **浏览器兼容性**：推荐使用 Chrome/Edge，Safari 可能有兼容性问题

## 🚀 未来优化方向

- [ ] 离线语言包支持（减少首次加载时间）
- [ ] 多区域同时识别（一次框选多个气泡）
- [ ] 智能对话分离（自动区分左右气泡）
- [ ] 支持表情符号识别
- [ ] 历史记录功能（保存识别过的截图）

---

💬 **常见问题**

**Q: 识别速度很慢怎么办？**  
A: 第一次使用需要下载语言包，之后会快很多。可以尝试框选更小的区域。

**Q: 识别结果不准确？**  
A: 请在校对窗口手动修改，或者重新框选更清晰的区域。

**Q: 粘贴功能不工作？**  
A: 确保你已经复制了图片（不是文件路径），并且浏览器有剪贴板权限。

**Q: 模态框无法关闭？**  
A: 点击右上角的 ✕ 按钮，或点击模态框外的灰色区域。
